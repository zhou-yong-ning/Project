# 项目脚本汇总

# 录信息

```q
//镇名与村名
zhen = "金湖街道"
cun = "柯庄村村民委员会"
//(调查中/未调查)
调查 = "调查中"  
//调查 = "未调查"
//安全设置
cr1 = GetPixelColor(1151, 652)
Do Until cr1 ="FB803B"  
    Delay 200
    cr1 = GetPixelColor(1151, 652)  
Loop
Delay 200
//开始执行
MoveTo 1351, 281
Delay 100
LeftDoubleClick 1
'双击复制
Delay 100
Call 复制()
Delay 100
fwbh = Plugin.Sys.GetCLB 
//表格一基本信息
MoveTo 1265, 373
Delay 150
LeftClick 1
//镇
//MoveTo 1314, 460
//Delay 100
//LeftClick 1
//cr2 = GetPixelColor(1377, 531)
//i = 1
//Do Until cr2 ="B77A33"  
//    Delay 100
//    cr2 = GetPixelColor(1377, 531)
//    i = i + 1
//    If i=20 Then  
//        Call 刷新网页()
//    End If 
//Loop
//Delay 150
//SayString zhen
//Delay 50
//KeyPress 13,1
//村
//MoveTo 1551, 456
//Delay 100
//LeftClick 1
//cr3 = GetPixelColor(1581,531)
//Do Until cr3 ="B77A33"  
//    Delay 100
//    cr3 = GetPixelColor(1581,531)  
//Loop
//Delay 100
//SayString cun
//Delay 100
//KeyPress 13, 1
//Delay 50
//MoveTo 1643,584
//Delay 100
//LeftClick 1
//选择表格 查询
MoveTo 172, 1059
Delay 100
LeftClick 1
Delay 200
//调出查找框
KeyDown 17, 1
KeyPress 70, 1
KeyUp 17, 1
Delay 100
KeyPress "BackSpace", 20
//粘贴
Delay 100
Call 粘贴()
Delay 100
//回车
KeyDown "Enter", 1
Delay 100
KeyUp "Enter", 1
Delay 300
//复制宗地码
KeyPress 27, 1
Delay 100
KeyPress 39, 1
Delay 50
Call 复制()
Delay 50
房屋类型 = Plugin.Sys.GetCLB()
Delay 50
fwlx = Mid(房屋类型, 13, 2)
If fwbh = 房屋类型 Then 
    KeyPress 27, 1
    Delay 100
    Call 无宗地码()
    结构 = 5
    Goto 表三、四
End If
//获取姓名
KeyPress 39, 1
Delay 50
Call 复制()
Delay 50
姓名 = Plugin.Sys.GetCLB()
//获取身份证
KeyPress 39,1
Delay 50
Call 复制()
Delay 50
身份证 = Plugin.Sys.GetCLB()
//获取小区
KeyPress 39,1
Delay 50
Call 复制()
Delay 50
小区 = Plugin.Sys.GetCLB()
//获取组
KeyPress 39,1
Delay 50
Call 复制()
Delay 50
组 = Plugin.Sys.GetCLB()
//获取号
KeyPress 39,1
Delay 50
Call 复制()
Delay 50
号 = Plugin.Sys.GetCLB()
//获取层
KeyPress 39,1
Delay 50
Call 复制()
Delay 50
楼层 = Plugin.Sys.GetCLB()
//获取面积
KeyPress 39,1
Delay 50
Call 复制()
Delay 50
面积 = Plugin.Sys.GetCLB()
//判断是否住宅
If fwlx = "JB" Then 
    Call 公共设施类()
    Goto 表三、四
End If
//填写姓名
MoveTo 123, 1059
Delay 30
LeftClick 1
Delay 100
MoveTo 1311, 582
Delay 100
LeftClick 1
Delay 100
Call 全选()
Delay 50
SayString 姓名
Delay 30
//填写身份证
MoveTo 1311, 632
Delay 50
LeftClick 1
Delay 30
Call 全选()
Delay 50
SayString 身份证
Delay 30
//填写小区
MoveTo 1480, 511
Delay 50
LeftClick 1
Delay 30
Call 全选()
Delay 50
SayString 小区
Delay 30
//填写组
MoveTo 1310, 512
Delay 50
LeftClick 1
Delay 30
Call 全选()
Delay 50
SayString 组
Delay 30
//填写号
MoveTo 1720, 512
Delay 50
LeftClick 1
Delay 50
Call 全选()
Delay 50
SayString 号
Delay 100
//填写楼层
MoveTo 1256, 220
Delay 50
LeftClick 1
Delay 300
MoveTo 1280,280
Delay 50
LeftClick 1
Delay 50
Call 全选()
Delay 50
SayString 楼层
//填写面积
MoveTo 1280, 330
Delay 50
LeftClick 1
Delay 50
Call 全选()
Delay 50
SayString 面积
//建造方式，安全鉴定
//MoveTo 1357,580
//Delay 200
//LeftClick 1
//MoveTo 1415,670
//Delay 200
//LeftClick 1
//MoveTo 1410,730
//Delay 200
//LeftClick 1
//填年份
//If 年份 <= 1980 Then 
//    MoveTo 1265,390
//    Delay 100
//    LeftClick 1
//    Delay 100
//ElseIf 年份>=1981 and 年份<=1990 Then  
//    MoveTo 1388,390
//    Delay 100
//    LeftClick 1
//    Delay 100
//ElseIf 年份>=1991 and 年份<=2000 Then
//    MoveTo 1504,390
//    Delay 100
//    LeftClick 1
//    Delay 200
//ElseIf 年份>=2001 and 年份<= 2010 Then
//    MoveTo 1266,419
//    Delay 100
//    LeftClick 1
//    Delay 100
//ElseIf 年份 >= 2011 and 年份 <= 2015 Then  
//    MoveTo 1382,419
//    Delay 100
//    LeftClick 1
//    Delay 100
//ElseIf 年份 >= 2016 and 年份 <=2022 Then      
//    MoveTo 1498,419
//    Delay 100
//    LeftClick 1
//    Delay 100
//Else 
//End If
//判断结构类型
//Select Case 结构
//Case 5
//    //砖石结构预制版
//    MoveTo 1266,463
//    Delay 150
//    LeftClick 1
//    MoveTo 1266,580
//    Delay 150
//    LeftClick 1
//    MoveTo 1268,623
//    Delay 150
//    LeftClick 1
//    MoveTo 1319,665 
//    Delay 150
//    LeftClick 1
//Case 6
//    //生土结构
//    MoveTo 1357,463
//    Delay 150
//    LeftClick 1
//    MoveTo 1266,580
//    Delay 150
//    LeftClick 1
//Case 9
//    //砖石结构木或轻钢楼屋盖
//    MoveTo 1266,463
//    Delay 150
//    LeftClick 1
//    MoveTo 1266,580
//    Delay 150
//    LeftClick 1
//    MoveTo 1422,623
//    Delay 150
//    LeftClick 1
//    MoveTo 1319,665 
//    Delay 150
//    LeftClick 1
//Case Else
//End Select
//Rem 表三、四
//抗震设防信息
//MoveTo 1369,224
//Delay 100
//LeftClick 1
//条件判断
//Delay 200
//MoveTo 1343, 281
//Delay 80
//LeftClick 1
//MoveTo 1345, 325
//Delay 80
//LeftClick 1
//MoveTo 1343, 386
//Delay 80
//LeftClick 1
//MoveTo 1340, 439
//Delay 80
//LeftClick 1
//添加照片
//IfColor 1213,820,"AA9C00",0 Then
//    MoveTo 1213,820
//    Delay 100
//    LeftClick 1
//    cr照片2 = GetPixelColor(480,90)
//    Do Until cr照片2 ="F7F6F5"  
//        Delay 100
//        cr照片2 = GetPixelColor(480,90)  
//    Loop
//    MoveTo 229,167
//    Delay 100
//    LeftDoubleClick 1
//    Delay 300
//Else    
//End If
//Delay 200
//Rem 表四
//安全隐患排查
//MoveTo 1519, 224
//Delay 50
//LeftClick 1
//Delay 100
//条件判断
//cr3 = GetPixelColor(1266,281)
//Do Until cr3 ="AA9C01"  
//    Delay 200
//    cr3 = GetPixelColor(1266,281)  
//Loop 
//用地手续
//MoveTo 1431,377
//Delay 50
//LeftClick 1
//MoveTo 1431,443
//Delay 30
//LeftClick 1
//施工许可手续
//MoveTo 1431,425
//Delay 10
//LeftClick 1
//MoveTo 1431,495
//Delay 10
//LeftClick 1
//经营审批手续
//MoveTo 1431,476
//Delay 10
//LeftClick 1
//MoveTo 1431,544
//Delay 10
//LeftClick 1
//规划建设手续
//MoveTo 1750,376
//Delay 10
//LeftClick 1
//MoveTo 1750,449
//Delay 10
//LeftClick 1
//竣工验收手续
//MoveTo 1750,426
//Delay 10
//LeftClick 1
//MoveTo 1750,494
//Delay 10
//LeftClick 1
//房屋登记手续
//MoveTo 1750,476
//Delay 20
//LeftClick 1
//MoveTo 1750,545
//Delay 20
//LeftClick 1
//用能情况
//MoveTo 1329,576
//Delay 20
//LeftClick 1
//MoveTo 1331,616
//Delay 20
//LeftClick 1
//MoveTo 1379,617
//Delay 20
//LeftClick 1
//地质灾害隐患
//MoveTo 1303,807
//Delay 20
//LeftClick 1
//MoveTo 1309,876
//Delay 20
//LeftClick 1
//安全隐患判断
//Select Case 结构
//Case 5
//    Call 存在风险()
//Case Else
//    Call 基本安全()
//End Select
//完成
//Call 完成()
//Delay 500
//IfColor 1151,734,"FB803B",0 Then
//    //颜色一样
//    MoveTo 1416,630
//    Delay 30 
//    LeftClick 1
//    Delay 50
//    LeftDoubleClick 1
//    Delay 50
//    SayString "510681197902084120"
//    Delay 100
//    Call 完成
//End If
Rem 表三、四
Call 完成()
//点调查（判断调查条件）
cr1 = GetPixelColor(1124,401 )
Do Until cr1 ="676767"  
    Delay 200
    cr1 = GetPixelColor(1124,401 )  
Loop
//调查
cr000 = GetPixelColor(1870,395)
Do Until cr000 ="F9F9F9"  
    Delay 200
    cr000 = GetPixelColor(1870,395)  
Loop
MoveTo 1823,435
cr00 = GetPixelColor(1895,444)
Do Until cr00 ="ECECEC"  
    Delay 200
    cr00 = GetPixelColor(1895,444)  
Loop
Delay 200
LeftClick 1
Sub 无宗地码()
    MoveTo 123,1059
    LeftClick 1
    Delay 100
    //填路  
    MoveTo 1465, 512
    Delay 50
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    SayString "0"
    //填姓名  
    MoveTo 1292, 582
    Delay 50
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    SayString "不详"
    //输入固定身份证号
    MoveTo 1300, 630
    Delay 200
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    SayString "510681197902084120"
    Delay 10
    //填组
    MoveTo 1280, 512
    Delay 50
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    SayString "1"
    //表二固定值
    //填写楼层
    MoveTo 1256, 220
    Delay 50
    LeftClick 1
    Delay 100
    MoveTo 1280,280
    Delay 100
    LeftClick 1
    Delay 100
    Call 全选()
    Delay 50
    SayString "1"
    Delay 100
    //填写面积
    MoveTo 1280,330
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    SayString "50"
    Delay 100
    //    //建造方式，安全鉴定
    //    MoveTo 1357,580
    //    Delay 200
    //    LeftClick 1
    //    MoveTo 1415,670
    //    Delay 200
    //    LeftClick 1
    //    MoveTo 1410,730
    //    Delay 200
    //    LeftClick 1
    //    //年份默认1980年
    //    MoveTo 1265,390
    //    Delay 100
    //    LeftClick 1
    //    Delay 100
    //    //砖石结构预制版    
    //    MoveTo 1266,463
    //    Delay 200
    //    LeftClick 1
    //    MoveTo 1266,580
    //    Delay 200
    //    LeftClick 1
    //    MoveTo 1268,623
    //    Delay 200
    //    LeftClick 1
    //    MoveTo 1319,665 
    //    Delay 200
    //    LeftClick 1
End Sub
Sub 公共设施类()
    MoveTo 123,1059
    Delay 100
    LeftClick 1
    //改为非住宅
    MoveTo 1334, 331
    Delay 200
    LeftClick 1
    //    cr1 = GetPixelColor(1374,411)
    //    Do Until cr1 ="343434"  
    //        Delay 100
    //        cr1 = GetPixelColor(1374,411)  
    //    Loop
    //    Delay 500
    //    MoveTo 1325, 415
    //    Delay 200
    //    LeftClick 1
    //    Delay 100
    //    cr1 = GetPixelColor(1318,489)
    //    Do Until cr1 ="B77A33"  
    //        Delay 100
    //        cr1 = GetPixelColor(1318,489)  
    //    Loop
    //    Delay 300
    //    //镇    
    //    SayString zhen
    //    Delay 100
    //    KeyPress 13,1
    //    //村  
    //    MoveTo 1560,407 
    //    Delay 100
    //    LeftClick 1
    //    cr1 = GetPixelColor(1561,489)
    //    Do Until cr1 ="B77A33"  
    //        Delay 100
    //        cr1 = GetPixelColor(1561,489)  
    //    Loop
    //    Delay 100
    //    SayString cun
    //    Delay 100
    //    KeyPress 13,1
    //粘贴房屋名    
    MoveTo 1301, 539
    Delay 100
    LeftClick 1
    Delay 100
    Call 全选()
    Delay 100
    SayString 姓名
    Delay 100
    MoveTo 1327, 584
    Delay 100
    LeftClick 1
    Delay 100
    Call 全选()
    Delay 100
    SayString 姓名
    Delay 100
    //    //勾选使用人  
    //    MoveTo 1637, 586
    //    Delay 100
    //    LeftClick 1
    //    Delay 100 
    //填写小区  
    MoveTo 1478,464
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 100
    SayString 小区
    Delay 50
    //填写组
    MoveTo 1316,469 
    LeftClick 1
    Delay 100
    Call 全选()
    Delay 100
    SayString 组
    Delay 100
    //填写号  
    MoveTo 1710,467 
    LeftClick 1
    Delay 100
    Call 全选()
    Delay 100
    SayString 号
    Delay 100
    //填写楼层
    MoveTo 1256, 220
    Delay 100
    LeftClick 1
    Delay 100
    MoveTo 1280,280
    Delay 100
    LeftClick 1
    Delay 100
    Call 全选()
    Delay 100
    SayString 楼层
    Delay 100
    //填写面积
    MoveTo 1280, 330
    Delay 50
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 100
    SayString 面积
    Delay 100
    //    //填写年份
    //    //填年份
    //    If 年份 <= 1980 Then 
    //        MoveTo 1265,390
    //        Delay 100
    //        LeftClick 1
    //        Delay 100
    //    ElseIf 年份>=1981 and 年份<=1990 Then  
    //        MoveTo 1388,390
    //        Delay 100
    //        LeftClick 1
    //        Delay 100
    //    ElseIf 年份>=1991 and 年份<=2000 Then
    //        MoveTo 1504,390
    //        Delay 100
    //        LeftClick 1
    //        Delay 200
    //    ElseIf 年份>=2001 and 年份<= 2010 Then
    //        MoveTo 1266,419
    //        Delay 100
    //        LeftClick 1
    //        Delay 100
    //    ElseIf 年份 >= 2011 and 年份 <= 2015 Then  
    //        MoveTo 1382,419
    //        Delay 100
    //        LeftClick 1
    //        Delay 100
    //    ElseIf 年份 >= 2016 and 年份 <=2022 Then      
    //        MoveTo 1498,419
    //        Delay 100
    //        LeftClick 1
    //        Delay 100
    //    Else 
    //    End If
    //    //是否安全鉴定 
    //    MoveTo 1415,804
    //    Delay 150
    //    LeftClick 1
    //    MoveTo 1410,864
    //    Delay 150
    //    LeftClick 1
    //    //建筑用途  
    //    MoveTo 1450,667
    //    Delay 150
    //    LeftClick 1
    //    //建造方式  
    //    MoveTo 1357,580
    //    Delay 150
    //    LeftClick 1
    //    //结构类型
    //    Select Case 结构
    //    Case 5
    //        //砖石结构预制版(红)
    //        MoveTo 1266,463
    //        Delay 200
    //        LeftClick 1
    //        MoveTo 1266,580
    //        Delay 200
    //        LeftClick 1
    //        MoveTo 1268,623
    //        Delay 200
    //        LeftClick 1
    //        MoveTo 1319,665 
    //        Delay 200
    //        LeftClick 1
    //    Case 6
    //        //生土结构
    //        MoveTo 1357,463
    //        Delay 150
    //        LeftClick 1
    //        MoveTo 1266,580
    //        Delay 150
    //        LeftClick 1
    //    Case 9
    //        //砖石结构木或轻钢楼层（深绿）
    //        MoveTo 1266,463
    //        Delay 200
    //        LeftClick 1
    //        MoveTo 1266,580
    //        Delay 200
    //        LeftClick 1
    //        MoveTo 1422,623
    //        Delay 200
    //        LeftClick 1
    //        MoveTo 1319,665 
    //        Delay 200
    //        LeftClick 1
    //    Case Else
    //        //空白
    //    End Select
    //    //切换至表三  
    //    MoveTo 1369,224
    //    Delay 150
    //    LeftClick 1
    //    //条件判断
    //    Delay 100
    //    cr1 = GetPixelColor(1212,835)
    //    Do Until cr1 ="AA9C00"  
    //        Delay 200
    //        cr1 = GetPixelColor(1212,835)  
    //    Loop
    //    Delay 200
    //    MoveTo 1343, 281
    //    LeftClick 1
    //    Delay 100
    //    MoveTo 1345, 325
    //    LeftClick 1
    //    Delay 100
    //    MoveTo 1343, 386
    //    LeftClick 1
    //    Delay 100
    //    MoveTo 1340, 439
    //    LeftClick 1
    //    Delay 100
    //    //添加照片
    //    cr照片1 = GetPixelColor(1213,834)
    //    Do Until cr照片1 ="AA9C00"  
    //        Delay 100
    //        cr照片1 = GetPixelColor(1213,834)  
    //    Loop
    //    MoveTo 1213,834
    //    Delay 100
    //    LeftClick 1
    //    cr照片2 = GetPixelColor(480,90)
    //    Do Until cr照片2 ="F7F6F5"  
    //        Delay 100
    //        cr照片2 = GetPixelColor(480,90)  
    //    Loop
    //    MoveTo 229,167
    //    Delay 100
    //    LeftDoubleClick 1
    //    Delay 500
End Sub
Sub 复制()
    KeyDown 17, 1
    KeyPress 67, 1
    KeyUp 17, 1
End Sub
Sub 粘贴()
    KeyDown 17, 1
    KeyPress 86, 1
    KeyUp 17, 1
End Sub
Sub 基本安全()
    MoveTo 1300,856
    Delay 20
    LeftClick 1
    MoveTo 1311,895
    Delay 20
    LeftClick 1
End Sub
Sub 存在风险()
    MoveTo 1300,856
    Delay 30
    LeftClick 1
    MoveTo 1311,916
    Delay 30 
    LeftClick 1
    Delay 30
    MoveTo 1520,790
    LeftClick 1
    Delay 50
    MouseWheel -20
    Delay 50
    MoveTo 1520,803
    Delay 100
    LeftClick 1
End Sub
Sub 刷新网页()
    Delay 500
    KeyPress "F5", 1
    Delay 5000
    crwy = GetPixelColor(582,100)  
    Do Until crwy = "FFFFFF"
        KeyPress "F5", 1
        Delay 5000
        crwy = GetPixelColor(582,100)  
    Loop
    MoveTo 541, 99
    Delay 500
    LeftClick 1
    Delay 500
    MoveTo 541, 149
    Delay 500
    LeftClick 1
    Delay 500
    crwy2 = GetPixelColor(1200,340)  
    Do Until crwy2 = "F9F9F9"
        Delay 200
        crwy2 = GetPixelColor(1200,340)  
    Loop
    // 选择村
    Delay 1000
    //  查询  
    MoveTo 1154,209
    Delay 500
    LeftClick 1
    crwy4 = GetPixelColor(1438,405)
    Do Until crwy4 ="AA9C01"  
        Delay 200
        crwy4 = GetPixelColor(1438,405)  
    Loop
    MoveTo 1295,305
    Delay 500
    LeftClick 1
    Delay 500
    查询村 = Left(cun, 3)
    Delay 500
    SayString 查询村
    //  点查询  
    MoveTo 1474,405
    Delay 500
    LeftClick 1
    Delay 500
    //  点村  
    MoveTo 1776, 608
    crwy6 = GetPixelColor(1855,598)
    Do Until crwy6 ="ECECEC"  
        Delay 200
        crwy6 = GetPixelColor(1855,598)  
    Loop   
    Delay 500
    LeftClick 1
    Select Case 调查
    Case "调查中"
        // 选择调查中
        MoveTo 1226, 318
        Delay 1000
        LeftClick 1
        Delay 500
    Case Else
    End Select
    //点调查（判断调查条件）
    cr1 = GetPixelColor(1124,401 )
    Do Until cr1 ="676767"  
        Delay 200
        cr1 = GetPixelColor(1124,401 )  
    Loop
    If 调查 = "调查中" Then 
        调查x = 1819 
    ElseIf 调查 = "未调查" Then
        调查x = 1653
    Else 
        EndScript
    End If
    MoveTo 调查x,401
    Delay 100
    LeftClick 1
    RestartScript
End Sub
Sub 完成()
    MoveTo 1564,945
    Delay 200
    LeftClick 1
    cr3 = GetPixelColor(1082,602 )
    Do Until cr3 <> "968A00"  
        Delay 100
        cr3 = GetPixelColor(1082,602 )  
    Loop
    Delay 200
    MoveTo 920,632
    Delay 100
    LeftClick 1
End Sub
Sub 全选()
    KeyDown 17, 1
    KeyPress 65, 1
    KeyUp 17, 1
End Sub

```

# 按键检核

```q
//安全设置
cr1 = GetPixelColor(1151,283)
Do Until cr1 ="FB803B"  
    Delay 200
    cr1 = GetPixelColor(1151,283)  
Loop
Delay 500
IfColor 1333,330, "AA9C01", 0 Then
    //非住宅
    cr2 = GetPixelColor(1758,412)
    Do Until cr2 ="343434"  
        Delay 200
        cr2 = GetPixelColor(1758,412)
    Loop
    Delay 200
    MoveTo 1744,414
    Delay 100
    LeftClick 1
    crsyr = GetPixelColor(1637,589)
    Do While crsyr ="AA9C01"  
        Delay 200
        crsyr = GetPixelColor(1637,589)  
    Loop
    Delay 200
    //选择村
    MoveTo 1741,645
    Delay 100
    LeftClick 1
Else 
    //住宅
    cr2 = GetPixelColor(1151,736)
    Do Until cr2 ="FB803B"  
        Delay 200
        cr2 = GetPixelColor(1151,736)  
    Loop
    Delay 200
    MoveTo 1731,457
    Delay 100
    LeftClick 1
    crsyr = GetPixelColor(1645,584)
    Do While crsyr ="AA9C01"  
        Delay 200
        crsyr = GetPixelColor(1645,584)  
    Loop
    Delay 200
    //选择村
    MoveTo 1707,690
    Delay 100
    LeftClick 1
End If
控制 = WaitKey()
Do While True
    If 控制 = 96 Then 
        Goto fanye
    End If
    If 控制 =39 Then 
        //		方向右键,点击通过
        Call 通过()
    ElseIf 控制 = 97 Then
        //    1
        Call 辅助用房()
    ElseIf 控制 = 98 Then
        //        2
        Call 全选()
        SayString "杨家洲生产队"
        Delay 200
        MoveTo 1912, 581
        Delay 50
        LeftClick 1
    ElseIf 控制 = 99 Then
        Call 全选()
        //        3
        SayString "510681197902084120"
        Delay 200
        MoveTo 1912, 581
        Delay 50
        LeftClick 1
    ElseIf 控制 = 100 Then
        //        4
        Call 存在风险()
    ElseIf 控制 = 101 Then
        //        5
        Call 基本安全()
    ElseIf 控制 = 102 Then
        //        6
        Call 查看照片()
    ElseIf 控制 = 103 Then
        //        7
        Call 住宅类()
        MoveTo 1896, 522
        Delay 100
        LeftClick 1
    ElseIf 控制 = 104 Then
        //        8
        Call 厕所类()
        MoveTo 1896, 522
        Delay 100
        LeftClick 1
    ElseIf 控制 = 105 Then
        Call 全选()
        //        9
        SayString "京南村村民委员会"
        MoveTo 1896, 522
        Delay 100
        LeftClick 1
    End If
    控制 = WaitKey()
    Rem fanye
    If 控制 = 96 Then
        Call 翻页()
    End If
Loop
Sub 全选()
    KeyDown 17, 1
    KeyPress 65, 1
    KeyUp 17, 1
End Sub
Sub 厕所类()
    //跳表四
    MoveTo 1546,221
    Delay 100
    LeftClick 1
    Delay 200
    crydsx = GetPixelColor(1278,378)
    If crydsx = "FFFFFF" or crydsx = "FEFEFE"  or crydsx = "FEFFFE" or crydsx = "FEFFFF" or crydsx = "FFFFFE" Then 
    Else 
        MoveTo 1424,373
        Delay 100
        LeftClick 1
        Delay 100
        MoveTo 1413,439
        Delay 100
        LeftClick 1
    End If
    //用能情况
    cn1 = GetPixelColor(1266,580)
    cn2 = GetPixelColor(1329,580)
    cn3 = GetPixelColor(1378,580)
    cn4 = GetPixelColor(1455,580)
    cs1 = GetPixelColor(1266,621)
    cs2 = GetPixelColor(1329,621)
    cs3 = GetPixelColor(1378,621)
    cs4 = GetPixelColor(1455,621)
    //采暖其他
    cr341 = GetPixelColor(1760,588)
    cr342 = GetPixelColor(1759,566)
    cr343 = GetPixelColor(1732,577)
    //炊事其他
    cr351 = GetPixelColor(1757,627)
    cr352 = GetPixelColor(1757,608)
    cr353 = GetPixelColor(1732,617)
    If cn1 = "FFFFFF" or cn1 = "FEFEFE"  or cn1 = "FEFFFE" or cn1 = "FEFFFF" or cn1 = "FFFFFE" or cn1 = "FFFEFE"  or cn1 = "FEFEFF"   Then 
    Else 
        MoveTo 1266,577
        Delay 100
        LeftClick 1
    End If
    If cn2 = "FFFFFF" or cn2 = "FEFEFE"  or cn2 = "FEFFFE" or cn2 = "FEFFFF" or cn2 = "FFFFFE" or cn2 = "FFFEFE"  or cn2 = "FEFEFF"   Then 
        //    MoveTo 1329,577
        //    Delay 100
        //    LeftClick 1
    Else 
        MoveTo 1329,577
        Delay 100
        LeftClick 1
    End If
    If cn3 = "FFFFFF" or cn3 = "FEFEFE"  or cn3 = "FEFFFE" or cn3 = "FEFFFF" or cn3 = "FFFFFE" or cn3 = "FFFEFE"   or cn3 = "FEFEFF"  Then 
    Else 
        MoveTo 1378,577
        Delay 100
        LeftClick 1
    End If
    If cn4 = "FFFFFF" or cn4 = "FEFEFE"  or cn4 = "FEFFFE" or cn4 = "FEFFFF" or cn4 = "FFFFFE" or cn4 = "FFFEFE"   or cn4 = "FEFEFF"  Then 
    Else 
        MoveTo 1455,577
        Delay 100
        LeftClick 1
    End If
    If cr341 = "EEEEEE" or cr342 = "EEEEEE" or cr343 = "EEEEEE" Then 
        MoveTo 1533,577
        Delay 100
        LeftClick 1
        MoveTo 1633,577
        Delay 100
        LeftClick 1
        Delay 100
        SayString "无"
    Else 
        //    MoveTo 1533,577
        //    Delay 100
        //    LeftClick 1
    End If
    If cs1 = "FFFFFF" or cs1 = "FEFEFE"  or cs1 = "FEFFFE" or cs1 = "FEFFFF"  or cs1 = "FFFFFE" or cs1 = "FFFEFE"  or cs1 = "FEFEFF"  Then 
    Else 
        MoveTo 1266,618
        Delay 100
        LeftClick 1
    End If
    If cs2 = "FFFFFF" or cs2 = "FEFEFE"  or cs2 = "FEFFFE" or cs2 = "FEFFFF" or  cs2 = "FFFFFE" or cs2 = "FFFEFE" or cs2 = "FEFEFF"  Then 
        //    MoveTo 1329,618
        //    Delay 100
        //    LeftClick 1
    Else 
        MoveTo 1329,618
        Delay 100
        LeftClick 1
    End If
    If cs3 = "FFFFFF" or cs3 = "FEFEFE"  or cs3 = "FEFFFE" or cs3 = "FEFFFF"  or cs3 = "FFFFFE" or cs3 = "FFFEFE"  or cs3 = "FEFEFF"  Then 
        //    MoveTo 1378,618
        //    Delay 100
        //    LeftClick 1
    Else 
        MoveTo 1378,618
        Delay 100
        LeftClick 1
    End If
    If cs4 = "FFFFFF" or cs4 = "FEFEFE"  or cs4 = "FEFFFE" or cs4 = "FEFFFF"  or cs4 = "FFFFFE" or cs4 = "FFFEFE"  or cs4 = "FEFEFF"  Then 
    Else 
        MoveTo 1455,618
        Delay 100
        LeftClick 1
    End If
    If cr351 = "EEEEEE" or cr352 = "EEEEEE" or cr353 = "EEEEEE" Then 
        MoveTo 1533,618
        Delay 100
        LeftClick 1
        MoveTo 1633,618
        Delay 100
        LeftClick 1
        Delay 100
        SayString "无"
    Else 
        //    MoveTo 1533,618
        //    Delay 100
        //    LeftClick 1
    End If
End Sub
Sub 住宅类()
    //跳表四
    MoveTo 1546,221
    Delay 100
    LeftClick 1
    Delay 200
    crydsx = GetPixelColor(1278,378)
    If crydsx = "FFFFFF" or crydsx = "FEFEFE"  or crydsx = "FEFFFE" or crydsx = "FEFFFF" or crydsx = "FFFFFE" Then 
    Else 
        MoveTo 1424,373
        Delay 100
        LeftClick 1
        Delay 100
        MoveTo 1413,439
        Delay 100
        LeftClick 1
    End If
    //用能情况
    cn1 = GetPixelColor(1266,580)
    cn2 = GetPixelColor(1329,580)
    cn3 = GetPixelColor(1378,580)
    cn4 = GetPixelColor(1455,580)
    cs1 = GetPixelColor(1266,621)
    cs2 = GetPixelColor(1329,621)
    cs3 = GetPixelColor(1378,621)
    cs4 = GetPixelColor(1455,621)
    //采暖其他
    cr341 = GetPixelColor(1760,588)
    cr342 = GetPixelColor(1759,566)
    cr343 = GetPixelColor(1732,577)
    //炊事其他
    cr351 = GetPixelColor(1757,627)
    cr352 = GetPixelColor(1757,608)
    cr353 = GetPixelColor(1732,617)
    If cn1 = "FFFFFF" or cn1 = "FEFEFE"  or cn1 = "FEFFFE" or cn1 = "FEFFFF" or cn1 = "FFFFFE" or cn1 = "FFFEFE"  or cn1 = "FEFEFF"   Then 
    Else 
        MoveTo 1266,577
        Delay 100
        LeftClick 1
    End If
    If cn2 = "FFFFFF" or cn2 = "FEFEFE"  or cn2 = "FEFFFE" or cn2 = "FEFFFF" or cn2 = "FFFFFE" or cn2 = "FFFEFE"  or cn2 = "FEFEFF"   Then 
        MoveTo 1329,577
        Delay 100
        LeftClick 1
    Else 
        //        MoveTo 1329,577
        //        Delay 100
        //        LeftClick 1
    End If
    If cn3 = "FFFFFF" or cn3 = "FEFEFE"  or cn3 = "FEFFFE" or cn3 = "FEFFFF" or cn3 = "FFFFFE" or cn3 = "FFFEFE"   or cn3 = "FEFEFF"  Then 
    Else 
        MoveTo 1378,577
        Delay 100
        LeftClick 1
    End If
    If cn4 = "FFFFFF" or cn4 = "FEFEFE"  or cn4 = "FEFFFE" or cn4 = "FEFFFF" or cn4 = "FFFFFE" or cn4 = "FFFEFE"   or cn4 = "FEFEFF"  Then 
    Else 
        MoveTo 1455,577
        Delay 100
        LeftClick 1
    End If
    If cr341 = "EEEEEE" or cr342 = "EEEEEE" or cr343 = "EEEEEE" Then 
        //        MoveTo 1533,577
        //        Delay 100
        //        LeftClick 1
        //        MoveTo 1633,577
        //        Delay 100
        //        LeftClick 1
        //        Delay 100
        //        SayString "无"
    Else 
        MoveTo 1533,577
        Delay 100
        LeftClick 1
    End If
    If cs1 = "FFFFFF" or cs1 = "FEFEFE"  or cs1 = "FEFFFE" or cs1 = "FEFFFF"  or cs1 = "FFFFFE" or cs1 = "FFFEFE"  or cs1 = "FEFEFF"  Then 
    Else 
        MoveTo 1266,618
        Delay 100
        LeftClick 1
    End If
    If cs2 = "FFFFFF" or cs2 = "FEFEFE"  or cs2 = "FEFFFE" or cs2 = "FEFFFF" or  cs2 = "FFFFFE" or cs2 = "FFFEFE" or cs2 = "FEFEFF"  Then 
        MoveTo 1329,618
        Delay 100
        LeftClick 1
    Else 
        //        MoveTo 1329,618
        //        Delay 100
        //        LeftClick 1
    End If
    If cs3 = "FFFFFF" or cs3 = "FEFEFE"  or cs3 = "FEFFFE" or cs3 = "FEFFFF"  or cs3 = "FFFFFE" or cs3 = "FFFEFE"  or cs3 = "FEFEFF"  Then 
        MoveTo 1378,618
        Delay 100
        LeftClick 1
    Else 
        //        MoveTo 1378,618
        //        Delay 100
        //        LeftClick 1
    End If
    If cs4 = "FFFFFF" or cs4 = "FEFEFE"  or cs4 = "FEFFFE" or cs4 = "FEFFFF"  or cs4 = "FFFFFE" or cs4 = "FFFEFE"  or cs4 = "FEFEFF"  Then 
    Else 
        MoveTo 1455,618
        Delay 100
        LeftClick 1
    End If
    If cr351 = "EEEEEE" or cr352 = "EEEEEE" or cr353 = "EEEEEE" Then 
        //        MoveTo 1533,618
        //        Delay 100
        //        LeftClick 1
        //        MoveTo 1633,618
        //        Delay 100
        //        LeftClick 1
        //        Delay 100
        //        SayString "无"
    Else 
        MoveTo 1533,618
        Delay 100
        LeftClick 1
    End If
End Sub
Sub 通过()
    MoveTo 1148, 221
    Delay 100
    LeftClick 1
    Delay 100
    MoveTo 1847,615
    Delay 100
    LeftClick 1
    Delay 100
    MouseWheel - 50 
    //    点击 
    Delay 500
    IfColor 1266, 763, "AA9C01", 2 Then
    Else 
        MoveTo 1266,763
        Delay 100
        LeftClick 1
    End If
    //提交
    MoveTo 1472,945
    Delay 100
    LeftClick 1
    cr1 = GetPixelColor(1082,633)
    Do While cr1 ="968A00"  
        Delay 200
        cr1 = GetPixelColor(1082,633)  
    Loop
    MoveTo 920, 632
    Delay 100
    LeftClick 1
    Delay 700
    IfColor 1070, 485, "F7F7F7", 0 Then
        MoveTo 999,618
        Delay 100
        LeftClick 1
    Else
    End If
    cr1 = GetPixelColor(1082,633)
    Do Until cr1 ="968A00"  
        Delay 200
        cr1 = GetPixelColor(1082,633)  
    Loop
    //调查
    cr000 = GetPixelColor(1888,357)
    Do Until cr000 ="F9F9F9"  
        Delay 200
        cr000 = GetPixelColor(1888,357)  
    Loop
    MoveTo 1702,400
    cr00 = GetPixelColor(1896,413)
    Do Until cr00 ="ECECEC"  
        Delay 200
        cr00 = GetPixelColor(1896,413)  
    Loop
    Delay 200
    LeftClick 1
    RestartScript
End Sub
Sub 翻页()
    x = 1
    Do Until 控制 <> 96
        If 控制 = 96 Then 
            余 = x Mod 4
            Select Case 余 
            Case 1
                //表二
                MoveTo 1255, 221
                Delay 100
                LeftClick 1
            Case 2
                //表三
                MoveTo 1375,221
                Delay 100
                LeftClick 1
            Case 3
                //表四
                MoveTo 1539,221
                Delay 100
                LeftClick 1
                Delay 300
            Case 0
                // 表一  
                MoveTo 1148, 221
                Delay 100
                LeftClick 1
            Case Else
            End Select
            x = x + 1
        Else 
        End If
        控制 = WaitKey()
    Loop
End Sub
Sub 基本安全()
    //跳表四
    MoveTo 1539,221
    Delay 100
    LeftClick 1
    Delay 500
    MoveTo 1300,856
    Delay 100
    LeftClick 1
    Delay 100
    MoveTo 1311,895
    Delay 100
    LeftClick 1
End Sub
Sub 存在风险()
    //跳表四
    MoveTo 1539,221
    Delay 100
    LeftClick 1
    Delay 500
    MoveTo 1300,856
    Delay 100
    LeftClick 1
    Delay 100
    MoveTo 1311,916
    Delay 100
    LeftClick 1
    Delay 100
    MoveTo 1520, 790
    Delay 50
    LeftClick 1
    Delay 100
    MouseWheel -20
    Delay 100
    MoveTo 1520,803
    Delay 100
    LeftClick 1
End Sub
Sub 查看照片()
    MoveTo 1375,221
    Delay 100
    LeftClick 1
    Delay 500
    MoveTo 1355,725 
    Delay 100
    LeftClick 1
    Delay 2000
    KeyPress "Right", 1
    Delay 1500
    KeyPress "Right", 1
    Delay 1000
    KeyPress "Esc", 1
End Sub
Sub 辅助用房()
    //复制主房编号
    MoveTo 1382, 280
    Delay 50
    LeftDoubleClick 1
    Delay 100
    Call 复制()
    zfbh = Plugin.Sys.GetCLB 
    Delay 100
    //检查辅助用房
    MoveTo 1382,735
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 100
    fzfbh1 = Plugin.Sys.GetCLB
    Delay 50
    If fzfbh1 = zfbh Then 
        Goto 完成
    Else 
        MoveTo 1755,732
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If 
    //滚动
    MoveTo 1888,456
    Delay 100
    LeftClick 1
    Delay 100
    MouseWheel - 8 
    Delay 200
    //2
    MoveTo 1390,276
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 50
    fzfbh2 = Plugin.Sys.GetCLB
    Delay 50
    If fzfbh2 = fzfbh1 or Len(fzfbh2)<>15 Then 
        Goto 完成
    Else 
        MoveTo 1755,279
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If
    //3
    MoveTo 1388,620 
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 50
    fzfbh3 = Plugin.Sys.GetCLB
    Delay 50
    If fzfbh3 = fzfbh2 or Len(fzfbh3)<>15 Then 
        num = 2
        Goto 完成
    Else 
        MoveTo 1755,620
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If
    //滚动
    MoveTo 1888,456
    Delay 100
    LeftClick 1
    Delay 100
    MouseWheel - 7
    Delay 200
    //4
    MoveTo 1388,266
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 50
    fzfbh4 = Plugin.Sys.GetCLB
    Delay 50
    fzfbhs4 = CStr(fzfbh4)
    Delay 50
    If fzfbh4 = fzfbh3 or Len(fzfbh4)<>15 Then 
        Goto 完成
    Else 
        MoveTo 1755,266
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If
    //5
    MoveTo 1381,608
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 50
    fzfbh5 = Plugin.Sys.GetCLB
    Delay 50
    If fzfbh5 = fzfbh4 or Len(fzfbh5)<>15 Then 
        Goto 完成
    Else 
        //跳转表格
        MoveTo 1755,608
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If
    //滚动
    MoveTo 1888,456
    Delay 100
    LeftClick 1
    Delay 100
    MouseWheel - 6
    Delay 200
    //6
    MoveTo 1381,352
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 50
    fzfbh6 = Plugin.Sys.GetCLB
    Delay 50
    If fzfbh6 = fzfbh5 or Len(fzfbh6)<>15 Then 
        Goto 完成
    Else 
        MoveTo 1755,352
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If
    //7
    MoveTo 1381,697
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 50
    fzfbh7 = Plugin.Sys.GetCLB
    Delay 50
    If fzfbh7 = fzfbh6 or Len(fzfbh7)<>15 Then 
        Goto 完成
    Else 
        MoveTo 1755,697
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If
    //滚动
    MoveTo 1888,456
    Delay 100
    LeftClick 1
    Delay 100
    MouseWheel - 7
    Delay 200
    //8
    MoveTo 1320,340
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 50
    fzfbh8 = Plugin.Sys.GetCLB
    Delay 50
    If fzfbh8 = fzfbh7 or Len(fzfbh8)<>15 Then 
        Goto 完成
    Else 
        //跳转表格
        MoveTo 1755,340
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If
    //9
    MoveTo 1381,683
    Delay 50
    LeftDoubleClick 1
    Delay 50
    Call 复制()
    Delay 50
    fzfbh9 = Plugin.Sys.GetCLB
    Delay 50
    If fzfbhs9 = fzfbhs8 or Len(fzfbhs9)<>15 Then
        Goto 完成
    Else 
        MoveTo 1755,683
        Delay 50
        LeftClick 1
        Delay 50
        Call 辅助用房信息获取()
    End If
    Rem 完成
    MoveTo 1868, 816
    Delay 100
    LeftClick 1
    Delay 100
    MouseWheel 20
End Sub
Sub 复制()
    KeyDown 17, 1
    KeyPress 67, 1
    KeyUp 17, 1
End Sub
Sub 辅助用房信息获取()
    //安全措施
    crfz = GetPixelColor(1210,515)
    Do Until crfz ="EEEEEE"  
        Delay 200
        crfz = GetPixelColor(1210,515)  
    Loop
    Delay 300
    cryt1 = GetPixelColor(702,557)
    cryt2 = GetPixelColor(765,557)
    cryt3 = GetPixelColor(828,557)
    cryt4 = GetPixelColor(891,557)
    cryt5 = GetPixelColor(954,557)
    cryt6 = GetPixelColor(702, 593)
    If cryt1 <> "FFFFFF" Then 
        yt = "厨房"
    ElseIf cryt2 <> "FFFFFF" Then
        yt = "厕所"
    ElseIf cryt3 <> "FFFFFF" Then
        yt = "车库"
    ElseIf cryt4 <> "FFFFFF" Then
        yt = "仓库"
    ElseIf cryt5 <> "FFFFFF" Then
        yt = "养殖圈舍"
    ElseIf cryt6 <> "FFFFFF" Then
        yt = "其他"
    End If
    //表三
    MoveTo 833,264
    Delay 50
    LeftClick 1
    Delay 500
    //审批手续
    crydsx = GetPixelColor(713,422)
    //    crjssx = GetPixelColor(1052,422)
    //    crsgsx = GetPixelColor(713,471)
    //    cryssx = GetPixelColor(1052,471)
    //    crspsx = GetPixelColor(713,520)
    //    crdjsx = GetPixelColor(1052,520)
    If crydsx = "FFFFFF" or crydsx = "FEFEFE"  or crydsx = "FEFFFE" or crydsx = "FEFFFF" or crydsx = "FFFFFE" Then 
    Else 
        MoveTo 863,419 
        Delay 100
        LeftClick 1
        Delay 100
        MoveTo 863,482
        Delay 100
        LeftClick 1
    End If
    //用能情况
    cn1 = GetPixelColor(701,623)
    cn2 = GetPixelColor(764,623)
    cn3 = GetPixelColor(813,623)
    cn4 = GetPixelColor(890,623)
    cs1 = GetPixelColor(701,664)
    cs2 = GetPixelColor(764,664)
    cs3 = GetPixelColor(813,664)
    cs4 = GetPixelColor(890,664)
    //采暖其他
    cr341 = GetPixelColor(1175,610)
    cr342 = GetPixelColor(1175,630)
    cr343 = GetPixelColor(1190,615)
    //炊事其他
    cr351 = GetPixelColor(1175,650)
    cr352 = GetPixelColor(1173,671)
    cr353 = GetPixelColor(1190,661)
    If yt = "厨房" Then 
        If cn1 = "FFFFFF" or cn1 = "FEFEFE"  or cn1 = "FEFFFE" or cn1 = "FEFFFF" or cn1 = "FFFFFE" or cn1 = "FFFEFE"  or cn1 = "FEFEFF"   Then 
        Else 
            MoveTo 701,620
            Delay 100
            LeftClick 1
        End If
        If cn2 = "FFFFFF" or cn2 = "FEFEFE"  or cn2 = "FEFFFE" or cn2 = "FEFFFF" or cn2 = "FFFFFE" or cn2 = "FFFEFE"  or cn2 = "FEFEFF"   Then 
            MoveTo 764,620
            Delay 100
            LeftClick 1
        Else 
        End If
        If cn3 = "FFFFFF" or cn3 = "FEFEFE"  or cn3 = "FEFFFE" or cn3 = "FEFFFF" or cn3 = "FFFFFE" or cn3 = "FFFEFE"   or cn3 = "FEFEFF"  Then 
        Else 
            MoveTo 813,620
            Delay 100
            LeftClick 1
        End If
        If cn4 = "FFFFFF" or cn4 = "FEFEFE"  or cn4 = "FEFFFE" or cn4 = "FEFFFF" or cn4 = "FFFFFE" or cn4 = "FFFEFE"   or cn4 = "FEFEFF"  Then 
        Else 
            MoveTo 890,620
            Delay 100
            LeftClick 1
        End If
        If cr341 = "EEEEEE" or cr342 = "EEEEEE" or cr343 = "EEEEEE" Then 
        Else 
            MoveTo 969,620
            Delay 100
            LeftClick 1
        End If
        If cs1 = "FFFFFF" or cs1 = "FEFEFE"  or cs1 = "FEFFFE" or cs1 = "FEFFFF"  or cs1 = "FFFFFE" or cs1 = "FFFEFE"  or cs1 = "FEFEFF"  Then 
        Else 
            MoveTo 701,661
            Delay 100
            LeftClick 1
        End If
        If cs2 = "FFFFFF" or cs2 = "FEFEFE"  or cs2 = "FEFFFE" or cs2 = "FEFFFF" or  cs2 = "FFFFFE" or cs2 = "FFFEFE" or cs2 = "FEFEFF"  Then 
            MoveTo 764,661
            Delay 100
            LeftClick 1
        Else 
        End If
        If cs3 = "FFFFFF" or cs3 = "FEFEFE"  or cs3 = "FEFFFE" or cs3 = "FEFFFF"  or cs3 = "FFFFFE" or cs3 = "FFFEFE"  or cs3 = "FEFEFF"  Then 
            MoveTo 813,661
            Delay 100
            LeftClick 1
        Else 
        End If
        If cs4 = "FFFFFF" or cs4 = "FEFEFE"  or cs4 = "FEFFFE" or cs4 = "FEFFFF"  or cs4 = "FFFFFE" or cs4 = "FFFEFE"  or cs4 = "FEFEFF"  Then 
        Else 
            MoveTo 890,661
            Delay 100
            LeftClick 1
        End If
        If cr351 = "EEEEEE" or cr352 = "EEEEEE" or cr353 = "EEEEEE" Then 
        Else 
            MoveTo 1070,659
            Delay 100
            LeftClick 1
            Delay 50
            Call 全选()
            Delay 50
            Call 复制()
            Delay 50
            str = Plugin.Sys.GetCLB
            If str = "无" Then 
                MoveTo 969,661
                Delay 100
                LeftClick 1
            End If
        End If
    Else 
        If cn1 = "FFFFFF" or cn1 = "FEFEFE"  or cn1 = "FEFFFE" or cn1 = "FEFFFF" or cn1 = "FFFFFE" or cn1 = "FFFEFE"  or cn1 = "FEFEFF"   Then 
        Else 
            MoveTo 701,620
            Delay 100
            LeftClick 1
        End If
        If cn2 = "FFFFFF" or cn2 = "FEFEFE"  or cn2 = "FEFFFE" or cn2 = "FEFFFF" or cn2 = "FFFFFE" or cn2 = "FFFEFE"  or cn2 = "FEFEFF"   Then 
        Else 
            MoveTo 764,620
            Delay 100
            LeftClick 1
        End If
        If cn3 = "FFFFFF" or cn3 = "FEFEFE"  or cn3 = "FEFFFE" or cn3 = "FEFFFF" or cn3 = "FFFFFE" or cn3 = "FFFEFE"   or cn3 = "FEFEFF"  Then 
        Else 
            MoveTo 813,620
            Delay 100
            LeftClick 1
        End If
        If cn4 = "FFFFFF" or cn4 = "FEFEFE"  or cn4 = "FEFFFE" or cn4 = "FEFFFF" or cn4 = "FFFFFE" or cn4 = "FFFEFE"   or cn4 = "FEFEFF"  Then 
        Else 
            MoveTo 890,620
            Delay 100
            LeftClick 1
        End If
        If cr341 = "EEEEEE" or cr342 = "EEEEEE" or cr343 = "EEEEEE" Then 
            MoveTo 969,620
            Delay 100
            LeftClick 1
            MoveTo 1070,620
            Delay 100
            LeftClick 1
            Delay 100
            SayString "无"
        Else 
        End If
        If cs1 = "FFFFFF" or cs1 = "FEFEFE"  or cs1 = "FEFFFE" or cs1 = "FEFFFF"  or cs1 = "FFFFFE" or cs1 = "FFFEFE"  or cs1 = "FEFEFF"  Then 
        Else 
            MoveTo 701,661
            Delay 100
            LeftClick 1
        End If
        If cs2 = "FFFFFF" or cs2 = "FEFEFE"  or cs2 = "FEFFFE" or cs2 = "FEFFFF" or  cs2 = "FFFFFE" or cs2 = "FFFEFE" or cs2 = "FEFEFF"  Then 
        Else 
            MoveTo 764,661
            Delay 100
            LeftClick 1
        End If
        If cs3 = "FFFFFF" or cs3 = "FEFEFE"  or cs3 = "FEFFFE" or cs3 = "FEFFFF"  or cs3 = "FFFFFE" or cs3 = "FFFEFE"  or cs3 = "FEFEFF"  Then 
        Else 
            MoveTo 813,661
            Delay 100
            LeftClick 1
        End If
        If cs4 = "FFFFFF" or cs4 = "FEFEFE"  or cs4 = "FEFFFE" or cs4 = "FEFFFF"  or cs4 = "FFFFFE" or cs4 = "FFFEFE"  or cs4 = "FEFEFF"  Then 
        Else 
            MoveTo 890,661
            Delay 100
            LeftClick 1
        End If
        If cr351 = "EEEEEE" or cr352 = "EEEEEE" or cr353 = "EEEEEE" Then 
            MoveTo 969,661
            Delay 100
            LeftClick 1
            MoveTo 1070,659
            Delay 100
            LeftClick 1
            Delay 100
            SayString "无"
        Else        
        End If
    End If
    //取消
    MoveTo 919,875
    Delay 50
    LeftClick 1
    Delay 500
    MoveTo 995,872
    Delay 50
    LeftClick 1
    Delay 500
End Sub
```

# 反向爬取数据

```q
//安全设置
cr1 = GetPixelColor(1151,283)
Do Until cr1 ="FB803B"  
    Delay 200
    cr1 = GetPixelColor(1151,283)  
Loop
Delay 500
IfColor 1266, 330, "FFFFFF", 0 Then
    //非住宅
    cr2 = GetPixelColor(1637,589)
    Do Until cr2 ="AA9C01"  
        Delay 200
        cr2 = GetPixelColor(1637,589)  
    Loop
Else 
    //住宅
    cr2 = GetPixelColor(1151,736)
    Do Until cr2 ="FB803B"  
        Delay 200
        cr2 = GetPixelColor(1151,736)  
    Loop
End If
//复制编号
MoveTo 1330,280
Delay 50
LeftDoubleClick 1
Delay 50
Call 复制()
Delay 50
fwbh = Plugin.Sys.GetCLB 
fwbh = CStr(fwbh)
//房屋类别
IfColor 1266, 330, "FFFFFF", 0 Then
    Delay 200
    fwlb = "非住宅"
    //现场调查情况
    IfColor 1266,690, "AA9C01", 0 Then
        dc = "不需要调查"
        Call 不需要调查()
        Goto 调查
    Else
        dc = "需要调查"
    End If
    Call 非住宅()
Else 
    Delay 200
    fwlb = "住宅"
    //现场调查情况
    IfColor 1266, 847, "AA9C01", 0 Then
        dc = "不需要调查"
        Call 不需要调查()
        Goto 调查
    Else
        dc = "需要调查"
    End If
    Call 住宅()
End If
Call 完成()
cr000 = GetPixelColor(1845,361)
Do Until cr000 ="F9F9F9"  
    Delay 200
    cr000 = GetPixelColor(1845,361)  
Loop
Call 表格写入()
//调查
Rem 调查
y = 405
MoveTo 1815,y
cr00 = GetPixelColor(1890,y+20)
Do Until cr00 ="ECECEC"  
    Delay 200
    cr00 = GetPixelColor(1890,y+20)  
Loop
Delay 200
LeftClick 1
Sub 住宅()
    //复制姓名
    MoveTo 1283,582
    Delay 50
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    xm = Plugin.Sys.GetCLB
    Delay 50
    //复制身份证
    MoveTo 1282,631
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    sfz = Plugin.Sys.GetCLB
    //获取地址
    MoveTo 1277,511
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    zu = Plugin.Sys.GetCLB
    //组
    MoveTo 1446,513
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    lu = Plugin.Sys.GetCLB
    //跳转表二
    MoveTo 1256,221
    Delay 100
    LeftClick 1
    Delay 300
    //建筑层数，建筑面积
    MoveTo 1277,281
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    jzcs = Plugin.Sys.GetCLB
    MoveTo 1283,329
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    jzmj = Plugin.Sys.GetCLB
    //年份
    crn1 = GetPixelColor(1266,390)
    crn2 = GetPixelColor(1388,390)
    crn3 = GetPixelColor(1504,390)
    crn4 = GetPixelColor(1266,419)
    crn5 = GetPixelColor(1382,419)
    crn6 = GetPixelColor(1497,419)
    If crn1 <> "FFFFFF" Then 
        nf = "1980年及以前"
    ElseIf crn2 <> "FFFFFF" Then
        nf = "1980-1990年"
    ElseIf crn3 <> "FFFFFF" Then
        nf = "1991-2000年"
    ElseIf crn4 <> "FFFFFF" Then
        nf = "2001-2010年"
    ElseIf crn5 <> "FFFFFF" Then
        nf = "2010-2015年"
    ElseIf crn6 <> "FFFFFF" Then
        nf = "2016年及以后"
    Else 
        nf = "未填写"
    End If
    //结构类型 
    crjg1 = GetPixelColor(1266,463)
    crjg2 = GetPixelColor(1357,463)
    crjg3 = GetPixelColor(1448,463)
    crjg4 = GetPixelColor(1539,463)
    crjg5 = GetPixelColor(1266,492)
    crjg6 = GetPixelColor(1399,492)
    crjg7 = GetPixelColor(1476,492)
    If crjg1 <> "FFFFFF" Then 
        IfColor 1266,628,"FFFFFF",0 Then
            zsjg = "木或轻钢楼屋盖"
        Else    
            zsjg = "预制板"
        End If
        jglx = "砖石结构-"&zsjg
    ElseIf crjg2 <> "FFFFFF" Then
        IfColor 1266,580,"FFFFFF",0 Then
            tmjg = "木（竹）结构"
        Else    
            tmjg = "生土结构"
        End If
        jglx = "土木结构-"&tmjg
    ElseIf crjg3 <> "FFFFFF" Then
        jglx = "混杂结构"
    ElseIf crjg4 <> "FFFFFF" Then
        jglx = "窑洞"
    ElseIf crjg5 <> "FFFFFF" Then
        jglx = "钢筋混凝土结构"
    ElseIf crjg6 <> "FFFFFF" Then
        jglx = "钢结构"
    ElseIf crjg7 <> "FFFFFF" Then
        MoveTo 1325,525
        Delay 30
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        qtjg = Plugin.Sys.GetCLB
        Delay 50
        jglx = "其他结构-"&qtjg
    End If
    //建造方式
    If crjg1 <> "FFFFFF" Then 
        crjzfs1 = GetPixelColor(1266,725)
        crjzfs2 = GetPixelColor(1357,725)
        crjzfs3 = GetPixelColor(1476,725)
        crjzfs4 = GetPixelColor(1266, 762)
        If crjzfs1 = "AA9C01" Then 
            jzfs = "自行建造"
        ElseIf crjzfs2 = "AA9C01" Then
            jzfs = "建筑工匠建造"
        ElseIf crjzfs3 = "AA9C01" Then
            jzfs = "有资质的施工建造"
        ElseIf crjzfs4 = "AA9C01" Then
            jzfs = "其他建造"
        End If
        IfColor 1275,814,"FFFFFF",0 Then
            aqjd = "否"
        Else    
            aqjd = "是"
        End If
    ElseIf crjg2 <> "FFFFFF" Then
        crjzfs1 = GetPixelColor(1266,624)
        crjzfs2 = GetPixelColor(1357,624)
        crjzfs3 = GetPixelColor(1476,624)
        crjzfs4 = GetPixelColor(1266,661)
        If crjzfs1 = "AA9C01" Then 
            jzfs = "自行建造"
        ElseIf crjzfs2 = "AA9C01" Then
            jzfs = "建筑工匠建造"
        ElseIf crjzfs3 = "AA9C01" Then
            jzfs = "有资质的施工建造"
        ElseIf crjzfs4 = "AA9C01" Then
            jzfs = "其他建造"
        End If
        IfColor 1275,713,"FFFFFF",0 Then
            aqjd = "否"
        Else    
            aqjd = "是"
        End If
    Else 
        crjzfs1 = GetPixelColor(1266,580)
        crjzfs2 = GetPixelColor(1357,580)
        crjzfs3 = GetPixelColor(1476,580)
        crjzfs4 = GetPixelColor(1266,617)
        If crjzfs1 = "AA9C01" Then 
            jzfs = "自行建造"
        ElseIf crjzfs2 = "AA9C01" Then
            jzfs = "建筑工匠建造"
        ElseIf crjzfs3 = "AA9C01" Then
            jzfs = "有资质的施工建造"
        ElseIf crjzfs4 = "AA9C01" Then
            jzfs = "其他建造"
        End If
        IfColor 1275,669,"FFFFFF",0 Then
            aqjd = "否"
        Else    
            aqjd = "是"
        End If
    End If
    //表三
    MoveTo 1374,222
    Delay 100
    LeftClick 1
    Delay 300
    //判断
    IfColor 1339, 281, "FFFFFF", 1 Then
        zysj = "否"
    Else 
        zysj = "是"
    End If
    IfColor 1339, 325, "FFFFFF", 1 Then
        kzgz = "否"
        IfColor 1339,385 ,"FFFFFF", 1 Then
            kzjg = "否"
        Else 
            kzjg = "是"
        End If
        IfColor 1339,445, "FFFFFF", 1 Then
            ywlf = "否"
        Else 
            ywlf = "是"
        End If
    Else 
        kzgz = "是"
        IfColor 1339,504, "FFFFFF", 1 Then
            kzjg = "否"
        Else 
            kzjg = "是"
        End If
        IfColor 1339,564, "FFFFFF", 1 Then
            ywlf = "否"
        Else 
            ywlf = "是"
        End If
    End If
    //跳表四
    MoveTo 1519, 224
    Delay 50
    LeftClick 1
    Delay 100
    //条件判断
    cr表四 = GetPixelColor(1266,279)
    Do Until cr表四 = "AA9C01"  
        Delay 200
        cr表四 = GetPixelColor(1266,279)  
    Loop
    Delay 200
    crydsx = GetPixelColor(1278,378)
    crjssx = GetPixelColor(1604,378)
    crsgsx = GetPixelColor(1278,427)
    cryssx = GetPixelColor(1604,427)
    crspsx = GetPixelColor(1278,476)
    crdjsx = GetPixelColor(1604,476)
    If crydsx = "FFFFFF" Then 
        ydsx = "无"
    Else 
        ydsx = "有"
    End If
    If crjssx= "FFFFFF" Then 
        jssx = "无"
    Else 
        jssx = "有"
    End If
    If crsgsx = "FFFFFF" Then 
        sgsx = "无"
    Else 
        sgsx = "有"
    End If
    If cryssx= "FFFFFF" Then 
        yssx= "无"
    Else 
        yssx= "有"
    End If
    If crspsx = "FFFFFF" Then 
        spsx = "无"
    Else 
        spsx = "有"
    End If
    If crdjsx  = "FFFFFF" Then 
        djsx  = "无"
    Else 
        djsx  = "有"
    End If
    //用能情况
    //采暖用能
    cn1 = GetPixelColor(1266,580)
    cn2 = GetPixelColor(1329,580)
    cn3 = GetPixelColor(1378,580)
    cn4 = GetPixelColor(1455,580)
    cn5 = GetPixelColor(1532,580)
    cs1 = GetPixelColor(1266, 621)
    cs2 = GetPixelColor(1329, 621)
    cs3 = GetPixelColor(1378, 621)
    cs4 = GetPixelColor(1455, 621)
    cs5 = GetPixelColor(1532, 621)
    If cn1 <> "FFFFFF" Then 
        cn1 = "煤炭"
    Else 
        cn1 = ""
    End If
    If cn2 <> "FFFFFF" Then 
        cn2 = "电"
    Else 
        cn2 = ""
    End If
    If cn3 <> "FFFFFF" Then 
        cn3 = "液化气"
    Else 
        cn3 = ""
    End If
    If cn4 <> "FFFFFF" Then 
        cn4 = "天然气"
    Else 
        cn4 = ""
    End If
    If cn5 <> "FFFFFF" Then 
        MoveTo 1630,576
        Delay 30
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        qt = Plugin.Sys.GetCLB
        Delay 50
        cn5 = "其他"&qt
    Else 
        cn5 = ""
    End If
    If cs1 <> "FFFFFF" Then 
        cs1 = "煤炭"
    Else 
        cs1 = ""
    End If
    If cs2 <> "FFFFFF" Then 
        cs2 = "电"
    Else 
        cs2 = ""
    End If
    If cs3 <> "FFFFFF" Then 
        cs3 = "液化气"
    Else 
        cs3 = ""
    End If
    If cs4 <> "FFFFFF" Then 
        cs4 = "天然气"
    Else 
        cs4 = ""
    End If
    If cs5 <> "FFFFFF" Then 
        MoveTo 1630,617
        Delay 30
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        qt = Plugin.Sys.GetCLB
        Delay 50
        cs5 = "其他"&qt
    Else 
        cs5 = ""
    End If
    cnyn = cn1&cn2&cn3&cn4&cn4
    csyn = cs1 & cs2 & cs3 & cs4 & cs5
    //地址灾害隐患判断
    IfColor 1274, 808, "FFFFFF", 1 Then
        dzzhyh = "不存在"
        IfColor 1274, 857, "FFFFFF", 1 Then
            aqyhpd = "基本安全"
        Else 
            aqyhpd = "存在风险"
        End If
    Else 
        dzzhyh = "存在"
    End If
End Sub
Sub 非住宅()
    //复制姓名
    MoveTo 1276,538
    Delay 50
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    xm = Plugin.Sys.GetCLB
    Delay 50
    //复制身份证
    MoveTo 1274,588 
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    sfz = Plugin.Sys.GetCLB
    //获取地址
    MoveTo 1276,465
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    zu = Plugin.Sys.GetCLB
    //组
    MoveTo 1445,469
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    lu = Plugin.Sys.GetCLB
    //跳转表二
    MoveTo 1256,221
    Delay 100
    LeftClick 1
    Delay 300
    //建筑层数，建筑面积
    MoveTo 1277,281
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    jzcs = Plugin.Sys.GetCLB
    MoveTo 1283,329
    Delay 30
    LeftClick 1
    Delay 50
    Call 全选()
    Delay 50
    Call 复制()
    Delay 50
    jzmj = Plugin.Sys.GetCLB
    //年份
    crn1 = GetPixelColor(1266,390)
    crn2 = GetPixelColor(1388,390)
    crn3 = GetPixelColor(1504,390)
    crn4 = GetPixelColor(1266,419)
    crn5 = GetPixelColor(1382,419)
    crn6 = GetPixelColor(1497,419)
    If crn1 <> "FFFFFF" Then 
        nf = "1980年及以前"
    ElseIf crn2 <> "FFFFFF" Then
        nf = "1980-1990年"
    ElseIf crn3 <> "FFFFFF" Then
        nf = "1991-2000年"
    ElseIf crn4 <> "FFFFFF" Then
        nf = "2001-2010年"
    ElseIf crn5 <> "FFFFFF" Then
        nf = "2010-2015年"
    ElseIf crn6 <> "FFFFFF" Then
        nf = "2016年及以后"
    Else 
        nf = "未填写"
    End If
    //结构类型 
    crjg1 = GetPixelColor(1266,463)
    crjg2 = GetPixelColor(1357,463)
    crjg3 = GetPixelColor(1448,463)
    crjg4 = GetPixelColor(1266,492)
    crjg5 = GetPixelColor(1329,492)
    crjg6 = GetPixelColor(1462,492)
    crjg7 = GetPixelColor(1266,529)
    If crjg1 <> "FFFFFF" Then 
        IfColor 1266,628,"FFFFFF",0 Then
            zsjg = "木或轻钢楼屋盖"
        Else    
            zsjg = "预制板"
        End If
        jglx = "砖石结构-"&zsjg
    ElseIf crjg2 <> "FFFFFF" Then
        IfColor 1266,580,"FFFFFF",0 Then
            tmjg = "木（竹）结构"
        Else    
            tmjg = "生土结构"
        End If
        jglx = "土木结构-"&tmjg
    ElseIf crjg3 <> "FFFFFF" Then
        jglx = "混杂结构"
    ElseIf crjg4 <> "FFFFFF" Then
        jglx = "窑洞"
    ElseIf crjg5 <> "FFFFFF" Then
        jglx = "钢筋混凝土结构"
    ElseIf crjg6 <> "FFFFFF" Then
        jglx = "钢结构"
    ElseIf crjg7 <> "FFFFFF" Then
        MoveTo 1345,527
        Delay 30
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        qtjg = Plugin.Sys.GetCLB
        Delay 50
        jglx = "其他结构-"&qtjg
    End If
    //建造方式
    If crjg1 <> "FFFFFF" Then 
        crjzfs1 = GetPixelColor(1266,725)
        crjzfs2 = GetPixelColor(1357,725)
        crjzfs3 = GetPixelColor(1476,725)
        crjzfs4 = GetPixelColor(1651,725)
        If crjzfs1 = "AA9C01" Then 
            jzfs = "自行建造"
        ElseIf crjzfs2 = "AA9C01" Then
            jzfs = "建筑工匠建造"
        ElseIf crjzfs3 = "AA9C01" Then
            jzfs = "有资质的施工建造"
        ElseIf crjzfs4 = "AA9C01" Then
            jzfs = "其他建造"
        End If
        IfColor 1275,827,"FFFFFF",0 Then
            aqjd = "否"
        Else    
            aqjd = "是"
        End If
    ElseIf crjg2 <> "FFFFFF" Then
        crjzfs1 = GetPixelColor(1266,624)
        crjzfs2 = GetPixelColor(1357,624)
        crjzfs3 = GetPixelColor(1476,624)
        crjzfs4 = GetPixelColor(1266,661)
        If crjzfs1 = "AA9C01" Then 
            jzfs = "自行建造"
        ElseIf crjzfs2 = "AA9C01" Then
            jzfs = "建筑工匠建造"
        ElseIf crjzfs3 = "AA9C01" Then
            jzfs = "有资质的施工建造"
        ElseIf crjzfs4 = "AA9C01" Then
            jzfs = "其他建造"
        End If
        IfColor 1275,713,"FFFFFF",0 Then
            aqjd = "否"
        Else    
            aqjd = "是"
        End If
    Else 
        crjzfs1 = GetPixelColor(1266,580)
        crjzfs2 = GetPixelColor(1357,580)
        crjzfs3 = GetPixelColor(1476,580)
        crjzfs4 = GetPixelColor(1266,617)
        If crjzfs1 = "AA9C01" Then 
            jzfs = "自行建造"
        ElseIf crjzfs2 = "AA9C01" Then
            jzfs = "建筑工匠建造"
        ElseIf crjzfs3 = "AA9C01" Then
            jzfs = "有资质的施工建造"
        ElseIf crjzfs4 = "AA9C01" Then
            jzfs = "其他建造"
        End If
        IfColor 1275,669,"FFFFFF",0 Then
            aqjd = "否"
        Else    
            aqjd = "是"
        End If
    End If
    //表三
    MoveTo 1374,222
    Delay 100
    LeftClick 1
    Delay 300
    //判断
    IfColor 1339, 281, "FFFFFF", 1 Then
        zysj = "否"
    Else 
        zysj = "是"
    End If
    IfColor 1339, 325, "FFFFFF", 1 Then
        kzgz = "否"
        IfColor 1339,385 ,"FFFFFF", 1 Then
            kzjg = "否"
        Else 
            kzjg = "是"
        End If
        IfColor 1339,445, "FFFFFF", 1 Then
            ywlf = "否"
        Else 
            ywlf = "是"
        End If
    Else 
        kzgz = "是"
        IfColor 1339,504, "FFFFFF", 1 Then
            kzjg = "否"
        Else 
            kzjg = "是"
        End If
        IfColor 1339,564, "FFFFFF", 1 Then
            ywlf = "否"
        Else 
            ywlf = "是"
        End If
    End If
    //跳表四
    MoveTo 1519, 224
    Delay 50
    LeftClick 1
    Delay 100
    //条件判断
    cr表四 = GetPixelColor(1266,279)
    Do Until cr表四 = "AA9C01"  
        Delay 200
        cr表四 = GetPixelColor(1266,279)  
    Loop
    Delay 200
    crydsx = GetPixelColor(1278,378)
    crjssx = GetPixelColor(1604,378)
    crsgsx = GetPixelColor(1278,427)
    cryssx = GetPixelColor(1604,427)
    crspsx = GetPixelColor(1278,476)
    crdjsx = GetPixelColor(1604,476)
    If crydsx = "FFFFFF" Then 
        ydsx = "无"
    Else 
        ydsx = "有"
    End If
    If crjssx= "FFFFFF" Then 
        jssx = "无"
    Else 
        jssx = "有"
    End If
    If crsgsx = "FFFFFF" Then 
        sgsx = "无"
    Else 
        sgsx = "有"
    End If
    If cryssx= "FFFFFF" Then 
        yssx= "无"
    Else 
        yssx= "有"
    End If
    If crspsx = "FFFFFF" Then 
        spsx = "无"
    Else 
        spsx = "有"
    End If
    If crdjsx  = "FFFFFF" Then 
        djsx  = "无"
    Else 
        djsx  = "有"
    End If
    //用能情况
    //采暖用能
    cn1 = GetPixelColor(1266,580)
    cn2 = GetPixelColor(1329,580)
    cn3 = GetPixelColor(1378,580)
    cn4 = GetPixelColor(1455,580)
    cn5 = GetPixelColor(1532,580)
    cs1 = GetPixelColor(1266, 621)
    cs2 = GetPixelColor(1329, 621)
    cs3 = GetPixelColor(1378, 621)
    cs4 = GetPixelColor(1455, 621)
    cs5 = GetPixelColor(1532, 621)
    If cn1 <> "FFFFFF" Then 
        cn1 = "煤炭"
    Else 
        cn1 = ""
    End If
    If cn2 <> "FFFFFF" Then 
        cn2 = "电"
    Else 
        cn2 = ""
    End If
    If cn3 <> "FFFFFF" Then 
        cn3 = "液化气"
    Else 
        cn3 = ""
    End If
    If cn4 <> "FFFFFF" Then 
        cn4 = "天然气"
    Else 
        cn4 = ""
    End If
    If cn5 <> "FFFFFF" Then 
        MoveTo 1630,576
        Delay 30
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        qt = Plugin.Sys.GetCLB
        Delay 50
        cn5 = "其他"&qt
    Else 
        cn5 = ""
    End If
    If cs1 <> "FFFFFF" Then 
        cs1 = "煤炭"
    Else 
        cs1 = ""
    End If
    If cs2 <> "FFFFFF" Then 
        cs2 = "电"
    Else 
        cs2 = ""
    End If
    If cs3 <> "FFFFFF" Then 
        cs3 = "液化气"
    Else 
        cs3 = ""
    End If
    If cs4 <> "FFFFFF" Then 
        cs4 = "天然气"
    Else 
        cs4 = ""
    End If
    If cs5 <> "FFFFFF" Then 
        MoveTo 1630,617
        Delay 30
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        qt = Plugin.Sys.GetCLB
        Delay 50
        cs5 = "其他"&qt
    Else 
        cs5 = ""
    End If
    cnyn = cn1&cn2&cn3&cn4&cn4
    csyn = cs1 & cs2 & cs3 & cs4 & cs5
    //地址灾害隐患判断
    IfColor 1274, 808, "FFFFFF", 1 Then
        dzzhyh = "不存在"
        IfColor 1274, 857, "FFFFFF", 1 Then
            aqyhpd = "基本安全"
        Else 
            aqyhpd = "存在风险"
        End If
    Else 
        dzzhyh = "存在"
    End If
End Sub
Sub 完成()
    //保存
    //    Delay 100
    //    MoveTo 1394,945
    //    Delay 100
    //    LeftClick 1
    //完成
    Delay 100
    MoveTo 1564,945
    Delay 100
    LeftClick 1
    cr1 = GetPixelColor(1082,633)
    Do While cr1 ="968A00"  
        Delay 200
        cr1 = GetPixelColor(1082,633)  
    Loop
    MoveTo 920, 632
    Delay 100
    LeftClick 1
End Sub
Sub 复制()
    KeyDown 17, 1
    KeyPress 67, 1
    KeyUp 17, 1
End Sub
Sub 全选()
    KeyDown 17, 1
    KeyPress 65, 1
    KeyUp 17, 1
End Sub
Sub 表格写入()
    //写入表格
    MoveTo 175,1059
    Delay 30
    LeftClick 1
    Delay 200
    SayString fwbh
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString dc
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString fwlb
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString xm
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString sfz
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString zu
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString lu
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString jzcs
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString jzmj
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString nf
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString jglx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString jzfs
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString aqjd
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString zysj
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString kzgz
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString kzjg
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString ywlf
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString ydsx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString jssx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString sgsx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString yssx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString spsx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString djsx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString cnyn
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString csyn
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString dzzhyh
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString aqyhpd
    Delay 30
    KeyPress "Left", 26
    Delay 30
    KeyPress "Down", 1
    Delay 30
    MoveTo 123,1060
    Delay 30
    LeftClick 1
    Delay 100
End Sub
Sub 不需要调查()
    Call 完成()
    cr000 = GetPixelColor(1845,361)
    Do Until cr000 ="F9F9F9"  
        Delay 200
        cr000 = GetPixelColor(1845,361)  
    Loop
    //写入表格
    MoveTo 175,1059
    Delay 30
    LeftClick 1
    Delay 200
    SayString fwbh
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString dc
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString fwlb
    Delay 30
    KeyPress "Left", 2
    Delay 30
    KeyPress "Down", 1
    Delay 30
    MoveTo 123,1060
    Delay 30
    LeftClick 1
    Delay 100
End Sub
//510681197902084120
```

# 反向爬取照片数据

```q
For i=1 To 10
    //调查
    cr000 = GetPixelColor(1880,445)
    Do Until cr000 ="F9F9F9"  
        Delay 200
        cr000 = GetPixelColor(1880,445)  
    Loop
    MoveTo 1783,483+i*39
    cr00 = GetPixelColor(1896,483+i*39)
    Do Until cr00 ="ECECEC"  
        Delay 200
        cr00 = GetPixelColor(1896,483+i*39)  
    Loop
    Delay 200
    LeftClick 1
    //安全措施
    crchushi = GetPixelColor(1151, 283)
    Do Until crchushi ="FB803B"  
        Delay 200
        crchushi = GetPixelColor(1151, 283)  
    Loop
    Delay 200
    IfColor 1266,330, "AA9C01", 2 Then
        crzhu = GetPixelColor(1151, 735)
        Do Until crzhu ="FB803B"  
            Delay 200
            crzhu = GetPixelColor(1151, 735)  
        Loop
        Delay 200
        fwlx = "住宅"
        IfColor 1266, 847, "AA9C01", 2 Then
            dcqk = "不需要调查"
        Else 
            dcqk = "需要调查"
        End If
    Else 
        crzhu = GetPixelColor(1637,589)
        Do Until crzhu ="AA9C01"  
            Delay 200
            crzhu = GetPixelColor(1637,589)  
        Loop
        Delay 200
        IfColor 1266,690, "AA9C01", 2 Then
            dcqk = "不需要调查"
        Else 
            dcqk = "需要调查"
        End If
        fwlx = "非住宅"
    End If
    //复制主房编号
    MoveTo 1382, 280
    Delay 50
    LeftDoubleClick 1
    Delay 100
    Call 复制()
    zfbh = Plugin.Sys.GetCLB 
    Delay 100
    //跳表三
    MoveTo 1382, 220
    Delay 100
    LeftClick 1
    Delay 300
    If fwlx = "住宅" Then 
        IfColor 1286, 325, "AA9C01", 2 Then
            表三y = 833
        Else 
            表三y = 714
        End If
        cr1 = GetPixelColor(1221,表三y)
        cr2 = GetPixelColor(1411,表三y)
        cr3 = GetPixelColor(1601,表三y)
        //1
        MoveTo 1291,表三y-100
        Delay 100
        Call 照片另存()
        SayString zfbh&"(1)"
        Delay 100
        KeyPress "Enter", 1
        //2
        If cr2 = "8F7031" or cr3 = "8F7031" or cr2 = "8F7132" or cr3 = "8F7132" Then 
            Delay 500
            MoveTo 1479,表三y-100
            Delay 100
            Call 照片另存()
            SayString zfbh&"(2)"
            Delay 100
            KeyPress "Enter", 1
        End If
        //3
        If cr3 = "8F7031" or cr3 = "8F7132" Then 
            Delay 500
            MoveTo 1665,表三y-100
            Delay 100
            Call 照片另存()
            SayString zfbh&"(3)"
            Delay 100
            KeyPress "Enter", 1
        End If
    Else 
        IfColor 1286, 325, "AA9C01", 2 Then
            表三y = 848
        Else 
            表三y = 729
        End If
        cr1 = GetPixelColor(1221,表三y)
        cr2 = GetPixelColor(1411,表三y)
        cr3 = GetPixelColor(1601,表三y)
        //1
        MoveTo 1291,表三y-100
        Delay 100
        Call 照片另存()
        SayString zfbh&"(1)"
        Delay 100
        KeyPress "Enter", 1
        //2
        If cr2 = "8F7031" or cr3 = "8F7031" or cr2 = "8F7132" or cr3 = "8F7132" Then 
            Delay 500
            MoveTo 1479,表三y-100
            Delay 100
            Call 照片另存()
            SayString zfbh&"(2)"
            Delay 100
            KeyPress "Enter", 1
        End If
        //3
        If cr3 = "8F7031" or cr3 = "8F7132" Then 
            Delay 500
            MoveTo 1665,表三y-100
            Delay 100
            Call 照片另存()
            SayString zfbh&"(3)"
            Delay 100
            KeyPress "Enter", 1
        End If
    End If
    If fwlx = "住宅" Then 
        //检查辅助用房
        MoveTo 1151,220
        Delay 100
        LeftClick 1
        Delay 500
        MoveTo 1382,735
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 100
        fzfbh1 = Plugin.Sys.GetCLB
        Delay 50
        If fzfbh1 = zfbh Then 
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh1
            Delay 100
            KeyPress "Enter", 1
        End If 
        //滚动
        MoveTo 1888,456
        Delay 100
        LeftClick 1
        Delay 100
        MouseWheel - 8 
        Delay 200
        //2
        MoveTo 1390,276
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 50
        fzfbh2 = Plugin.Sys.GetCLB
        Delay 50
        If fzfbh2 = fzfbh1 or Len(fzfbh2)<>15 Then 
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh2
            Delay 100
            KeyPress "Enter", 1 
        End If
        //3
        MoveTo 1388,620 
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 50
        fzfbh3 = Plugin.Sys.GetCLB
        Delay 50
        If fzfbh3 = fzfbh2 or Len(fzfbh3)<>15 Then 
            num = 2
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh3
            Delay 100
            KeyPress "Enter", 1
        End If
        //滚动
        MoveTo 1888,456
        Delay 100
        LeftClick 1
        Delay 100
        MouseWheel - 7
        Delay 200
        //4
        MoveTo 1388,266
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 50
        fzfbh4 = Plugin.Sys.GetCLB
        Delay 50
        fzfbhs4 = CStr(fzfbh4)
        Delay 50
        If fzfbh4 = fzfbh3 or Len(fzfbh4)<>15 Then 
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh4
            Delay 100
            KeyPress "Enter", 1
        End If
        //5
        MoveTo 1381,608
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 50
        fzfbh5 = Plugin.Sys.GetCLB
        Delay 50
        If fzfbh5 = fzfbh4 or Len(fzfbh5)<>15 Then 
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh5
            Delay 100
            KeyPress "Enter", 1
        End If
        //滚动
        MoveTo 1888,456
        Delay 100
        LeftClick 1
        Delay 100
        MouseWheel - 6
        Delay 200
        //6
        MoveTo 1381,352
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 50
        fzfbh6 = Plugin.Sys.GetCLB
        Delay 50
        If fzfbh6 = fzfbh5 or Len(fzfbh6)<>15 Then 
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh6
            Delay 100
            KeyPress "Enter", 1
        End If
        //7
        MoveTo 1381,697
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 50
        fzfbh7 = Plugin.Sys.GetCLB
        Delay 50
        If fzfbh7 = fzfbh6 or Len(fzfbh7)<>15 Then 
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh7
            Delay 100
            KeyPress "Enter", 1
        End If
        //滚动
        MoveTo 1888,456
        Delay 100
        LeftClick 1
        Delay 100
        MouseWheel - 7
        Delay 200
        //8
        MoveTo 1320,340
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 50
        fzfbh8 = Plugin.Sys.GetCLB
        Delay 50
        If fzfbh8 = fzfbh7 or Len(fzfbh8)<>15 Then 
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh8
            Delay 100
            KeyPress "Enter", 1
        End If
        //9
        MoveTo 1381,683
        Delay 50
        LeftDoubleClick 1
        Delay 50
        Call 复制()
        Delay 50
        fzfbh9 = Plugin.Sys.GetCLB
        Delay 50
        If fzfbhs9 = fzfbhs8 or Len(fzfbhs9)<>15 Then
            Goto 完成
        Else 
            MoveR 0, 70
            Call 照片另存()
            SayString fzfbh9
            Delay 100
            KeyPress "Enter", 1
        End If
    End If
    Rem 完成
    //保存返回
    Delay 100
    MoveTo 1858,211
    Delay 100
    LeftClick 1
//    cr1 = GetPixelColor(1082,633)
//    Do While cr1 ="968A00"  
//        Delay 200
//        cr1 = GetPixelColor(1082,633)  
//    Loop
//    Delay 100
//    MoveTo 920,601
//    Delay 100
//    LeftClick 1
//    If dcqk = "不需要调查" Then 
//        Delay 1000
//        MoveTo 996,589
//        Delay 100
//        LeftClick 1
//    End If
    
Next
Delay 1000
MoveTo 1746, 935
Delay 200
LeftClick 1
Delay 1000
Sub 复制()
    KeyDown 17, 1
    KeyPress 67, 1
    KeyUp 17, 1
End Sub
Sub 辅助用房信息获取()
    //安全措施
    crfz = GetPixelColor(1210,515)
    Do Until crfz ="EEEEEE"  
        Delay 200
        crfz = GetPixelColor(1210,515)  
    Loop
    Delay 300
    cryt1 = GetPixelColor(702,557)
    cryt2 = GetPixelColor(765,557)
    cryt3 = GetPixelColor(828,557)
    cryt4 = GetPixelColor(891,557)
    cryt5 = GetPixelColor(954,557)
    cryt6 = GetPixelColor(702, 593)
    If cryt1 <> "FFFFFF" Then 
        yt = "厨房"
    ElseIf cryt2 <> "FFFFFF" Then
        yt = "厕所"
    ElseIf cryt3 <> "FFFFFF" Then
        yt = "车库"
    ElseIf cryt4 <> "FFFFFF" Then
        yt = "仓库"
    ElseIf cryt5 <> "FFFFFF" Then
        yt = "养殖圈舍"
    ElseIf cryt6 <> "FFFFFF" Then
        MoveTo 799,592
        Delay 50
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        ytqt = Plugin.Sys.GetCLB
        Delay 50
        yt = "其他" & ytqt
    End If
    //表二 
    MoveTo 683,264
    Delay 50
    LeftClick 1
    Delay 400
    craqjd = GetPixelColor(711, 326)
    If craqjd = "FFFFFF" or craqjd = "FEFEFE"  or craqjd = "FEFFFE" or craqjd = "FEFFFF" or craqjd = "FFFFFE" Then 
        aqjd = "否"
    Else 
        aqjd = "是"
    End If
    //表三
    MoveTo 833,264
    Delay 50
    LeftClick 1
    Delay 500
    //审批手续
    crydsx = GetPixelColor(713,422)
    crjssx = GetPixelColor(1052,422)
    crsgsx = GetPixelColor(713,471)
    cryssx = GetPixelColor(1052,471)
    crspsx = GetPixelColor(713,520)
    crdjsx = GetPixelColor(1052,520)
    If crydsx = "FFFFFF" or crydsx = "FEFEFE"  or crydsx = "FEFFFE" or crydsx = "FEFFFF" or crydsx = "FFFFFE" Then 
        ydsx = "无"
    Else 
        ydsx = "有"
    End If
    If crjssx= "FFFFFF" or crjssx = "FEFEFE"  or crjssx = "FEFFFE" or crjssx = "FEFFFF"  or crjssx = "FFFFFE"  Then 
        jssx = "无"
    Else 
        jssx = "有"
    End If
    If crsgsx = "FFFFFF" or crsgsx = "FEFEFE"  or crsgsx = "FEFFFE" or crsgsx = "FEFFFF"  or crsgsx = "FFFFFE" Then 
        sgsx = "无"
    Else 
        sgsx = "有"
    End If
    If cryssx= "FFFFFF" or cryssx = "FEFEFE"  or cryssx = "FEFFFE" or cryssx = "FEFFFF"  or cryssx = "FFFFFE"  Then 
        yssx= "无"
    Else 
        yssx= "有"
    End If
    If crspsx = "FFFFFF" or crspsx = "FEFEFE"  or crspsx = "FEFFFE" or crspsx = "FEFFFF"  or crspsx = "FFFFFE" Then 
        spsx = "无"
    Else 
        spsx = "有"
    End If
    If crdjsx  = "FFFFFF" or crdjsx = "FEFEFE"  or crdjsx = "FEFFFE" or crdjsx = "FEFFFF"  or crdjsx = "FFFFFE" Then 
        djsx  = "无"
    Else 
        djsx  = "有"
    End If
    //用能情况
    cn1 = GetPixelColor(701,623)
    cn2 = GetPixelColor(764,623)
    cn3 = GetPixelColor(813,623)
    cn4 = GetPixelColor(890,623)
    cs1 = GetPixelColor(701,664)
    cs2 = GetPixelColor(764,664)
    cs3 = GetPixelColor(813,664)
    cs4 = GetPixelColor(890,664)
    //采暖其他
    cr341 = GetPixelColor(1175,610)
    cr342 = GetPixelColor(1175,630)
    cr343 = GetPixelColor(1190,615)
    //炊事其他
    cr351 = GetPixelColor(1175,650)
    cr352 = GetPixelColor(1173,671)
    cr353 = GetPixelColor(1190,661)
    If cn1 = "FFFFFF" or cn1 = "FEFEFE"  or cn1 = "FEFFFE" or cn1 = "FEFFFF" or cn1 = "FFFFFE" or cn1 = "FFFEFE"  or cn1 = "FEFEFF"   Then 
        cn1 = ""
    Else 
        cn1 = "煤炭"
    End If
    If cn2 = "FFFFFF" or cn2 = "FEFEFE"  or cn2 = "FEFFFE" or cn2 = "FEFFFF" or cn2 = "FFFFFE" or cn2 = "FFFEFE"  or cn2 = "FEFEFF"   Then 
        cn2 = ""
    Else 
        cn2 = "电"
    End If
    If cn3 = "FFFFFF" or cn3 = "FEFEFE"  or cn3 = "FEFFFE" or cn3 = "FEFFFF" or cn3 = "FFFFFE" or cn3 = "FFFEFE"   or cn3 = "FEFEFF"  Then 
        cn3 = ""
    Else 
        cn3 = "液化气"
    End If
    If cn4 = "FFFFFF" or cn4 = "FEFEFE"  or cn4 = "FEFFFE" or cn4 = "FEFFFF" or cn4 = "FFFFFE" or cn4 = "FFFEFE"   or cn4 = "FEFEFF"  Then 
        cn4 = ""
    Else 
        cn4 = "天然气"
    End If
    If cr341 = "EEEEEE" or cr342 = "EEEEEE" or cr343 = "EEEEEE" Then 
        cn5 = ""
    Else 
        MoveTo 1060,618
        Delay 30
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        qt = Plugin.Sys.GetCLB
        Delay 50
        cn5 = "其他"&qt
    End If
    If cs1 = "FFFFFF" or cs1 = "FEFEFE"  or cs1 = "FEFFFE" or cs1 = "FEFFFF"  or cs1 = "FFFFFE" or cs1 = "FFFEFE"  or cs1 = "FEFEFF"  Then 
        cs1 = ""
    Else 
        cs1 = "煤炭"
    End If
    If cs2 = "FFFFFF" or cs2 = "FEFEFE"  or cs2 = "FEFFFE" or cs2 = "FEFFFF" or  cs2 = "FFFFFE" or cs2 = "FFFEFE" or cs2 = "FEFEFF"  Then 
        cs2 = ""
    Else 
        cs2 = "电"
    End If
    If cs3 = "FFFFFF" or cs3 = "FEFEFE"  or cs3 = "FEFFFE" or cs3 = "FEFFFF"  or cs3 = "FFFFFE" or cs3 = "FFFEFE"  or cs3 = "FEFEFF"  Then 
        cs3 = ""
    Else 
        cs3 = "液化气"
    End If
    If cs4 = "FFFFFF" or cs4 = "FEFEFE"  or cs4 = "FEFFFE" or cs4 = "FEFFFF"  or cs4 = "FFFFFE" or cs4 = "FFFEFE"  or cs4 = "FEFEFF"  Then 
        cs4 = ""
    Else 
        cs4 = "天然气"
    End If
    If cr351 = "EEEEEE" or cr352 = "EEEEEE" or cr353 = "EEEEEE" Then 
        cs5 = ""
    Else 
        MoveTo 1060,660
        Delay 30
        LeftClick 1
        Delay 50
        Call 全选()
        Delay 50
        Call 复制()
        Delay 50
        qt = Plugin.Sys.GetCLB
        Delay 50
        cs5 = "其他"&qt
    End If
    cnyn = cn1&cn2&cn3&cn4&cn5
    csyn = cs1 & cs2 & cs3 & cs4 & cs5
    //是否改造
    crsfgz = GetPixelColor(701, 753)
    If crsfgz = "FFFFFF" or crsfgz = "FEFEFE"  or crsfgz = "FEFFFE" or crsfgz = "FEFFFF" or  crsfgz = "FFFFFE" Then 
        sfgz = "是"
    Else 
        sfgz = "否"
    End If
    //取消
    MoveTo 995,872
    Delay 50
    LeftClick 1
    Delay 500
End Sub
Sub 全选()
    KeyDown 17, 1
    KeyPress 65, 1
    KeyUp 17, 1
End Sub
Sub 辅助用房信息填写()
    KeyPress "Right", 1
    Delay 30
    SayString yt
    KeyPress "Right", 1
    Delay 30
    SayString aqjd
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString ydsx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString jssx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString sgsx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString yssx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString spsx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString djsx
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString cnyn
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString csyn
    Delay 30
    KeyPress "Right", 1
    Delay 30
    SayString sfgz
    Delay 30
    KeyPress "Left", 11
    Delay 50
    KeyPress "Enter", 1
    Delay 50
End Sub
Sub 照片另存()
    Delay 100
    RightClick 1
    //照片另存
    MoveR 70, 37
    Delay 100
    LeftClick 1
    crz= GetPixelColor(536,91)
    Do Until crz ="F7F6F5"  
        Delay 200
        crz = GetPixelColor(536,91)  
    Loop
    Delay 200
End Sub

```

# 辅助用房修改

```q
cr0 = GetPixelColor(1151, 735)
Do Until cr0 ="FB803B"  
    Delay 200
    cr0 = GetPixelColor(1151, 735)  
Loop
Delay 300
IfColor 1339, 805, "FFFFFF", 0 Then
    Goto 完成
Else 
    Delay 200
    MoveTo 1755,732
    Delay 200
    LeftClick 1
    Call 辅助房屋检查()
End If
Delay 500
//滚动
MoveTo 1888,456
Delay 100
LeftClick 1
Delay 100
MouseWheel - 8 
Delay 200
//2
IfColor 1151, 280, "FB803A", 0 Then
    MoveTo 1755,276
    Delay 100
    LeftClick 1
    Call 辅助房屋检查()
    Delay 500
End If
//3
IfColor 1340,695, "FFFFFF", 1 Then
    MoveTo 1755,620
    Delay 100
    LeftClick 1
    Call 辅助房屋检查()
Else 
    Goto 完成
End If
//滚动
MoveTo 1888,456
Delay 100
LeftClick 1
Delay 100
MouseWheel - 7
Delay 200
//4
IfColor 1151,267, "FB803A", 0 Then
    MoveTo 1755,265
    Delay 100
    LeftClick 1
    Call 辅助房屋检查()
    Delay 500
End If
//5
IfColor 1360,700, "FFFFFF", 1 Then
    MoveTo 1755,610
    Delay 100
    LeftClick 1
    Call 辅助房屋检查()
Else 
    Goto 完成
End If
//滚动
MoveTo 1888,456
Delay 100
LeftClick 1
Delay 100
MouseWheel - 6
Delay 200
//6
IfColor 1151,355, "FB803A", 0 Then
    MoveTo 1755,351
    Delay 100
    LeftClick 1
    Call 辅助房屋检查()
    Delay 500
End If
//7
IfColor 1360,770, "FFFFFF", 1 Then
    MoveTo 1755,695
    Delay 100
    LeftClick 1
    Call 辅助房屋检查()
Else 
    Goto 完成
End If
//保存并返回
Rem 完成
Delay 200
MoveTo 1395,945
Delay 100
LeftClick 1
//调查
cr000 = GetPixelColor(1828,360)
Do Until cr000 ="F9F9F9"  
    Delay 200
    cr000 = GetPixelColor(1828,360)  
Loop
MoveTo 1815,401
cr00 = GetPixelColor(1855,401)
Do Until cr00 ="ECECEC"  
    Delay 200
    cr00 = GetPixelColor(1855,401)  
Loop
Delay 200
LeftClick 1
Sub 辅助房屋检查()
    cr1 = GetPixelColor(1212,500)
    Do Until cr1 ="EEEEEE"  
        Delay 200
        cr1 = GetPixelColor(1212,500)
    Loop
    Delay 300
    cr2 = GetPixelColor(702,557)
    //跳表三
    MoveTo 833,264
    Delay 200
    LeftClick 1
    crb3 = GetPixelColor(1367,810)
    Do Until crb3 ="F5F5F5"  
        Delay 200
        crb3 = GetPixelColor(1367,810)
    Loop
    Delay 200
    //采暖电  
    cr311 = GetPixelColor(769,616)
    cr312 = GetPixelColor(766,625)
    cr313 = GetPixelColor(762,621)
    //炊事电  
    cr321 = GetPixelColor(761,663)
    cr322 = GetPixelColor(764,665)
    cr323 = GetPixelColor(767,660)
    //炊事气    
    cr331 = GetPixelColor(810,663)
    cr332 = GetPixelColor(813,664)
    cr333 = GetPixelColor(819,657)
    //采暖其他
    cr341 = GetPixelColor(1175,610)
    cr342 = GetPixelColor(1175,630)
    cr343 = GetPixelColor(1190,615)
    //炊事其他
    cr351 = GetPixelColor(1175,650)
    cr352 = GetPixelColor(1173,671)
    cr353 = GetPixelColor(1190,661)
    //用地手续
    MoveTo 863,419 
    Delay 100
    LeftClick 1
    MoveTo 863,482
    Delay 100
    LeftClick 1
    If cr2 = "AA9C00" Then 
        //采暖  
        If cr311 =  "FEFEFE" or cr312 =  "FEFEFE"  or cr313 =  "FEFEFE" or cr311 =  "FEFFFE" or cr312 =  "FEFFFE"  or cr313 =  "FEFFFE" or cr311 =  "FEFFFF" or cr312 =  "FEFFFF"  or cr313 =  "FEFFFF" Then
            MoveTo 766,620
            Delay 100
            LeftClick 1
        Else 
        End If
        //炊事电 
        If cr321 =  "FEFEFE" or cr322 =  "FEFEFE"  or cr323 =  "FEFEFE" or cr321 =  "FEFFFE" or cr322 =  "FEFFFE"  or cr323 =  "FEFFFE" or cr321 =  "FEFFFF" or cr322 =  "FEFFFF"  or cr323 =  "FEFFFF" Then
            MoveTo 766,661
            Delay 100
            LeftClick 1
        Else 
        End If
        //炊事气
        If cr331 =  "FEFEFE" or cr332 =  "FEFEFE" or cr333 =  "FEFEFE" or cr331 =  "FEFFFE" or cr332 =  "FEFFFE"  or cr333 =  "FEFFFE" or cr331 =  "FEFFFF" or cr332 =  "FEFFFF"  or cr333 =  "FEFFFF" Then
            MoveTo 815,661
            Delay 100
            LeftClick 1
        Else 
        End If
        Call 采暖其他无取消()
        Call 炊事其他无取消()
    Else 
        //采暖电 
        Delay 100
        If cr311 =  "FEFEFE" or cr312 =  "FEFEFE"  or cr313 =  "FEFEFE" or cr311 =  "FEFFFE" or cr312 =  "FEFFFE"  or cr313 =  "FEFFFE" or cr311 =  "FEFFFF" or cr312 =  "FEFFFF"  or cr313 =  "FEFFFF" Then
        Else 
            MoveTo 766,620
            Delay 200
            LeftClick 1
        End If
        Delay 100
        //炊事电 
        If cr321 =  "FEFEFE" or cr322 =  "FEFEFE"  or cr323 =  "FEFEFE" or cr321 =  "FEFFFE" or cr322 =  "FEFFFE"  or cr323 =  "FEFFFE" or cr321 =  "FEFFFF" or cr322 =  "FEFFFF"  or cr323 =  "FEFFFF" Then
        Else 
            MoveTo 766,661
            Delay 200
            LeftClick 1
        End If
        //炊事气
        Delay 100
        If cr331 =  "FEFEFE" or cr332 =  "FEFEFE" or cr333 =  "FEFEFE" or cr331 =  "FEFFFE" or cr332 =  "FEFFFE"  or cr333 =  "FEFFFE" or cr331 =  "FEFFFF" or cr332 =  "FEFFFF"  or cr333 =  "FEFFFF" Then
        Else 
            MoveTo 815,661
            Delay 200
            LeftClick 1
        End If
        Call 采暖其他无()
        Call 炊事其他无()
    End If
    //保存
    MoveTo 919, 871
    Delay 200
    LeftClick 1
    Delay 500
    MoveTo 995, 871
    Delay 200
    LeftClick 1
End Sub
Sub 采暖其他无()
    If cr341 = "EEEEEE" or cr342 = "EEEEEE" or cr343 = "EEEEEE" Then 
        MoveTo 969,620
        Delay 100
        LeftClick 1
        MoveTo 1070,620
        Delay 100
        LeftClick 1
        Delay 100
        SayString "无"
    Else 
    End If
End Sub
Sub 炊事其他无()
    If cr351 = "EEEEEE" or cr352 = "EEEEEE" or cr353 = "EEEEEE" Then 
        MoveTo 969,661
        Delay 100
        LeftClick 1
        MoveTo 1070,659
        Delay 100
        LeftClick 1
        Delay 100
        SayString "无"
    Else        
    End If
End Sub
Sub 采暖其他无取消()
    If cr341 = "EEEEEE" or cr342 = "EEEEEE" or cr343 = "EEEEEE" Then 
    Else 
        MoveTo 969,620
        Delay 100
        LeftClick 1
    End If
End Sub
Sub 炊事其他无取消()
    If cr351 = "EEEEEE" or cr352 = "EEEEEE" or cr353 = "EEEEEE" Then 
    Else 
        MoveTo 969,661
        Delay 100
        LeftClick 1
    End If
End Sub

```

